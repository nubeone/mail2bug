<?xml version="1.0"?>
<Config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Instances>
    <!-- 3iMedia Portfolio -->
    <InstanceConfig Name="Azure3iMediaBugGenerator">
      <TfsServerConfig>
        <SimulationMode>false</SimulationMode>
        <CollectionUri>https://dev.azure.com/3imedia/</CollectionUri>
        <ServiceIdentityUsername>muhannad.ali@3imedia.de</ServiceIdentityUsername>
        <ServiceIdentityPatKeyVaultSecret>
          <KeyVaultPath>https://mail2bugkv.vault.azure.net/secrets/mail2bug-pat</KeyVaultPath>
          <ApplicationIdEnvironmentVariableName>DIRECTORY_APPLICATION_ID</ApplicationIdEnvironmentVariableName>
          <ApplicationSecretEnvironmentVariableName>DIRECTORY_APPLICATION_SECRET</ApplicationSecretEnvironmentVariableName>
        </ServiceIdentityPatKeyVaultSecret>
        <Project>Portfolio</Project>
        <WorkItemTemplate>Product Backlog Item</WorkItemTemplate>
        <CacheQueryFile>.\Resources\Query.wiq</CacheQueryFile>
        <NamesListFieldName>Assigned To</NamesListFieldName>
      </TfsServerConfig>
      <WorkItemSettings>
        <ConversationIndexFieldName>Integration Build</ConversationIndexFieldName>
        <DefaultFieldValues>
          <DefaultValueDefinition Field="Assigned To" Value="Unassigned"/>
          <DefaultValueDefinition Field="Changed By" Value="##Sender"/>
          <DefaultValueDefinition Field="Description" Value="##MessageBodyWithSender"/>
          <DefaultValueDefinition Field="Area Path" Value="Portfolio"/>
          <DefaultValueDefinition Field="Iteration Path" Value="Portfolio"/>
        </DefaultFieldValues>
        <AttachOriginalMessage>true</AttachOriginalMessage>
      </WorkItemSettings>
      <EmailSettings>
        <Recipients/>
        <ReplyTemplate>.\Resources\ReplyTemplateExample.htm</ReplyTemplate>
        <EWSKeyVaultSecret>
          <KeyVaultPath>https://mail2bugkv.vault.azure.net/secrets/mailaccount-password</KeyVaultPath>
          <ApplicationIdEnvironmentVariableName>DIRECTORY_APPLICATION_ID</ApplicationIdEnvironmentVariableName>
          <ApplicationSecretEnvironmentVariableName>DIRECTORY_APPLICATION_SECRET</ApplicationSecretEnvironmentVariableName>
        </EWSKeyVaultSecret>
        <EWSMailboxAddress>issue@3imedia.de</EWSMailboxAddress>
        <EWSUsername>3imedia\issue</EWSUsername>
        <ServiceType>EWSByRecipients</ServiceType>
        <SendAckEmails>true</SendAckEmails>
        <AckEmailsRecipientsAll>true</AckEmailsRecipientsAll>
        <UseConversationGuidOnly>true</UseConversationGuidOnly>
        <AppendOnlyEmailTitleRegex>.*(issue)\s*#\s*(?&lt;id&gt;\d+)</AppendOnlyEmailTitleRegex>
        <AppendOnlyEmailBodyRegex>!!!(issue)\s*#\s*(?&lt;id&gt;\d+)</AppendOnlyEmailBodyRegex>
        <ExplicitOverridesRegex>###\s*(?&lt;fieldName&gt;[^:]*):\s*(?&lt;value&gt;.*)</ExplicitOverridesRegex>
      </EmailSettings>
    </InstanceConfig>
  </Instances>
</Config>